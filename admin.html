<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Panel</title>
    <link
      href="https://cdn.quilljs.com/1.3.6/quill.snow.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="login-overlay">
      <h2>Admin Panel</h2>
      <input
        type="email"
        id="emailInput"
        style="max-width: 280px; margin-bottom: 10px"
        placeholder="Email"
      />
      <input
        type="password"
        id="passInput"
        class="login-input"
        placeholder="Password"
      />
      <p id="loginError" class="form-error-msg"></p>
      <div class="btn-group login-btn-group">
        <button class="btn" id="loginBtn">Login</button>
        <button class="btn btn-home" id="exitLoginBtn">Exit</button>
      </div>
    </div>

    <!-- Modal de Confirmaci√≥n de Borrado (Alem√°n) -->
    <div id="delete-modal-overlay" class="modal-overlay-container">
      <div class="modal">
        <h3 style="color: #ff6b6b">Karte l√∂schen?</h3>
        <p>
          M√∂chten Sie diese Karte wirklich l√∂schen? Diese Aktion kann nicht
          r√ºckg√§ngig gemacht werden.
        </p>
        <div class="btn-group">
          <button class="btn btn-danger" id="confirmDeleteBtn">L√∂schen</button>
          <button class="btn btn-home" id="cancelDeleteBtn">Abbrechen</button>
        </div>
      </div>
    </div>

    <!-- Modal de √âxito -->
    <div id="modal-overlay">
      <div class="modal">
        <h3 id="successModalTitle">Karte geschpeichert!</h3>
        <p id="successModalMsg">Eine weitere Karte erstellen?</p>
        <div class="btn-group">
          <button class="btn" id="successModalYesBtn">Ja</button>
          <button class="btn btn-home" id="successModalNoBtn">
            Nein (Zur√ºck)
          </button>
        </div>
      </div>
    </div>

    <!-- Modal de Confirmaci√≥n de Borrado de Categor√≠a -->
    <div id="delete-cat-modal-overlay" class="modal-overlay-container">
      <div class="modal">
        <h3 style="color: #ff6b6b">Kategorie l√∂schen?</h3>
        <p id="delete-cat-msg"></p>
        <div class="btn-group">
          <button class="btn btn-danger" id="confirmDeleteCatBtn">
            L√∂schen
          </button>
          <button class="btn btn-home" id="cancelDeleteCatBtn">
            Abbrechen
          </button>
        </div>
      </div>
    </div>

    <!-- Modal de Edici√≥n de Categor√≠a -->
    <div id="edit-cat-modal-overlay" class="modal-overlay-container">
      <div class="modal">
        <h3>Kategorie bearbeiten</h3>
        <input
          type="text"
          id="editCatInput"
          placeholder="Category Name"
          style="margin-bottom: 1rem"
        />
        <div class="btn-group">
          <button class="btn" id="confirmEditCatBtn">Speichern</button>
          <button class="btn btn-home" id="cancelEditCatBtn">Abbrechen</button>
        </div>
      </div>
    </div>

    <div class="admin-container">
      <!-- Header Admin -->
      <div class="admin-header">
        <h2 class="admin-header-title" data-view-target="dashboard-view">
          Admin Panel
        </h2>
        <button class="btn btn-home btn-logout">Logout ‚ûú</button>
      </div>

      <!-- VISTA 1: DASHBOARD -->
      <div id="dashboard-view">
        <div class="dashboard-menu">
          <div class="dashboard-card" data-view-target="categories-view">
            <span style="font-size: 2rem">üìÇ</span>
            <h3>Admin Categories</h3>
          </div>
          <div class="dashboard-card" data-view-target="cards-view">
            <span style="font-size: 2rem">üóÇÔ∏è</span>
            <h3>Admin Cards</h3>
          </div>
        </div>
      </div>

      <!-- VISTA 2: CATEGORIAS -->
      <div id="categories-view" class="hidden">
        <h3>Manage Categories</h3>
        <div class="search-box" style="margin-bottom: 1.25rem">
          <input type="text" id="newCatInput" placeholder="New Category Name" />
          <div class="btn-group">
            <button class="btn btn-home" data-view-target="dashboard-view">
              Back to Dashboard
            </button>
            <button class="btn" id="addCatBtn">Add</button>
          </div>
        </div>
        <div id="categories-list" class="admin-list">
          <!-- Lista din√°mica -->
        </div>
      </div>

      <!-- VISTA 3: TARJETAS (LISTA) -->
      <div id="cards-view" class="hidden">
        <h3>Manage Cards</h3>

        <div class="btn-group" style="margin-bottom: 1.25rem">
          <button class="btn btn-home" data-view-target="dashboard-view">
            Back to Dashboard
          </button>
          <button class="btn" id="addCardBtn">Add a Card</button>
        </div>

        <div class="search-box" style="margin-bottom: 1.25rem">
          <input
            type="text"
            id="adminSearchInput"
            placeholder="Search by ID or Text..."
          />
          <div class="btn-group">
            <button class="btn btn-home" id="resetAdminSearchBtn">Reset</button>
            <button class="btn" id="searchAdminBtn">Suchen</button>
          </div>
          <p id="adminSearchStats" class="search-stats"></p>
        </div>
        <div id="cards-list" class="admin-list">
          <!-- Lista din√°mica -->
        </div>
      </div>

      <!-- VISTA 4: FORMULARIO TARJETA (CREAR/EDITAR) -->
      <div id="card-form-view" class="hidden">
        <h3 id="formTitle">Create Flashcard</h3>
        <form id="cardForm">
          <input type="hidden" id="editCardId" />
          <!-- ID oculto para edici√≥n -->
          <div class="btn-group" style="margin-bottom: 1.25rem">
            <button type="submit" class="btn" id="saveBtn">SAVE CARD</button>
            <button
              type="button"
              class="btn btn-danger"
              id="deleteBtn"
              style="display: none"
            >
              DELETE CARD
            </button>
            <button
              type="button"
              class="btn btn-cancel"
              data-view-target="cards-view"
            >
              CANCEL
            </button>
          </div>
          <p
            id="formError"
            class="form-error-msg"
            style="text-align: center"
          ></p>
          <div class="form-section">
            <label>Category</label>
            <select id="categorySelect">
              <option value="">Loading...</option>
            </select>
          </div>
          <div class="form-section">
            <label>Tags</label>
            <input type="text" id="tags" placeholder="scrum, tech, security" />
          </div>
          <div class="form-section">
            <label>Frontside Title (Question)</label>
            <input
              type="text"
              id="frontTitle"
              placeholder="Ej: ¬øQu√© es GDPR?"
              style="margin-bottom: 1rem"
            />

            <label>Frontside Content (Details/Image)</label>
            <div id="editor-front"></div>
          </div>
          <div class="form-section">
            <label>Backside (Answer/Details)</label>
            <div id="editor-back"></div>
          </div>
        </form>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.8/purify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase.js"></script>
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script src="admin.js" defer></script>
  </body>
</html>
