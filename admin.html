<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin-Panel</title>
    <link
      href="https://cdn.quilljs.com/1.3.6/quill.snow.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="login-overlay">
      <h2>Admin-Panel</h2>
      <input
        type="email"
        id="emailInput"
        style="max-width: 280px; margin-bottom: 10px"
        placeholder="E-Mail"
      />
      <input
        type="password"
        id="passInput"
        class="login-input"
        placeholder="Passwort"
      />
      <p id="loginError" class="form-error-msg"></p>
      <div class="btn-group login-btn-group">
        <button class="btn" id="loginBtn">Anmelden</button>
        <button class="btn btn-home" id="exitLoginBtn">Verlassen</button>
      </div>
    </div>

    <!-- Modal de Confirmación de Borrado (Alemán) -->
    <div id="delete-modal-overlay" class="modal-overlay-container">
      <div class="modal">
        <h3 style="color: #ff6b6b">Karte löschen?</h3>
        <p>
          Möchten Sie diese Karte wirklich löschen? Diese Aktion kann nicht
          rückgängig gemacht werden.
        </p>
        <div class="btn-group">
          <button class="btn btn-danger" id="confirmDeleteBtn">Löschen</button>
          <button class="btn btn-home" id="cancelDeleteBtn">Abbrechen</button>
        </div>
      </div>
    </div>

    <!-- Modal de Éxito -->
    <div id="modal-overlay">
      <div class="modal">
        <h3 id="successModalTitle">Karte geschpeichert!</h3>
        <p id="successModalMsg">Eine weitere Karte erstellen?</p>
        <div class="btn-group">
          <button class="btn" id="successModalYesBtn">Ja</button>
          <button class="btn btn-home" id="successModalNoBtn">
            Nein (Zurück)
          </button>
        </div>
      </div>
    </div>

    <!-- Modal de Confirmación de Borrado de Categoría -->
    <div id="delete-cat-modal-overlay" class="modal-overlay-container">
      <div class="modal">
        <h3 style="color: #ff6b6b">Kategorie löschen?</h3>
        <p id="delete-cat-msg"></p>
        <div class="btn-group">
          <button class="btn btn-danger" id="confirmDeleteCatBtn">
            Löschen
          </button>
          <button class="btn btn-home" id="cancelDeleteCatBtn">
            Abbrechen
          </button>
        </div>
      </div>
    </div>

    <!-- Modal de Edición de Categoría -->
    <div id="edit-cat-modal-overlay" class="modal-overlay-container">
      <div class="modal">
        <h3>Kategorie bearbeiten</h3>
        <input
          type="text"
          id="editCatInput"
          placeholder="Kategoriename"
          style="margin-bottom: 1rem"
        />
        <div class="btn-group">
          <button class="btn" id="confirmEditCatBtn">Speichern</button>
          <button class="btn btn-home" id="cancelEditCatBtn">Abbrechen</button>
        </div>
      </div>
    </div>

    <div class="admin-container">
      <!-- Header Admin -->
      <div class="admin-header">
        <h2 class="admin-header-title" data-view-target="dashboard-view">
          Admin-Panel
        </h2>
        <button class="btn btn-home btn-logout">Abmelden ➜</button>
      </div>

      <!-- VISTA 1: DASHBOARD -->
      <div id="dashboard-view">
        <h3>Dashboard</h3>
        <div class="dashboard-menu">
          <div class="dashboard-card" data-view-target="categories-view">
            <span style="font-size: 2rem">≔</span>
            <h3>Kategorien verwalten</h3>
          </div>
          <div class="dashboard-card" data-view-target="cards-view">
            <span style="font-size: 2rem">⊟</span>
            <h3>Karten verwalten</h3>
          </div>
        </div>
      </div>

      <!-- VISTA 2: CATEGORIAS -->
      <div id="categories-view" class="hidden">
        <h3>Kategorien verwalten</h3>
        <div class="search-box" style="margin-bottom: 1.25rem">
          <input
            type="text"
            id="newCatInput"
            placeholder="Neuer Kategoriename"
          />
          <div class="btn-group">
            <button class="btn btn-home" data-view-target="dashboard-view">
              Zurück zum Dashboard
            </button>
            <button class="btn" id="addCatBtn">Hinzufügen</button>
          </div>
        </div>
        <div id="categories-list" class="admin-list">
          <!-- Lista dinámica -->
        </div>
      </div>

      <!-- VISTA 3: TARJETAS (LISTA) -->
      <div id="cards-view" class="hidden">
        <h3>Karten verwalten</h3>

        <div class="btn-group" style="margin-bottom: 1.25rem">
          <button class="btn btn-home" data-view-target="dashboard-view">
            Zurück zum Dashboard
          </button>
          <button class="btn" id="addCardBtn">Karte hinzufügen</button>
        </div>

        <div class="search-box" style="margin-bottom: 1.25rem">
          <input
            type="text"
            id="adminSearchInput"
            placeholder="In allen Karten suchen..."
          />
          <div class="btn-group">
            <button class="btn btn-home" id="resetAdminSearchBtn">
              Zurücksetzen
            </button>
            <button class="btn" id="searchAdminBtn">Suchen</button>
          </div>
          <p id="adminSearchStats" class="search-stats"></p>
        </div>
        <div id="cards-list" class="admin-list">
          <!-- Lista dinámica -->
        </div>
      </div>

      <!-- VISTA 4: FORMULARIO TARJETA (CREAR/EDITAR) -->
      <div id="card-form-view" class="hidden">
        <h3 id="formTitle">Flashcard erstellen</h3>
        <form id="cardForm">
          <input type="hidden" id="editCardId" />
          <!-- ID oculto para edición -->
          <div class="btn-group" style="margin-bottom: 1.25rem">
            <button type="submit" class="btn" id="saveBtn">
              KARTE SPEICHERN
            </button>
            <button
              type="button"
              class="btn btn-danger"
              id="deleteBtn"
              style="display: none"
            >
              KARTE LÖSCHEN
            </button>
            <button
              type="button"
              class="btn btn-cancel"
              data-view-target="cards-view"
            >
              ABBRECHEN
            </button>
          </div>
          <p
            id="formError"
            class="form-error-msg"
            style="text-align: center"
          ></p>
          <div class="form-section">
            <label>Kategorie</label>
            <select id="categorySelect">
              <option value="">Laden...</option>
            </select>
          </div>
          <div class="form-section">
            <label>Tags</label>
            <input
              type="text"
              id="tags"
              placeholder="Scrum, Technik, Sicherheit"
            />
          </div>
          <div class="form-section">
            <label>Vorderseite Titel (Frage)</label>
            <input
              type="text"
              id="frontTitle"
              placeholder="z.B. Was ist die DSGVO?"
              style="margin-bottom: 1rem"
            />

            <label>Vorderseite Inhalt (Details/Bild)</label>
            <div id="editor-front"></div>
          </div>
          <div class="form-section">
            <label>Rückseite (Antwort/Details)</label>
            <div id="editor-back"></div>
          </div>
        </form>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.8/purify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase.js"></script>
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script src="admin.js" defer></script>
  </body>
</html>
